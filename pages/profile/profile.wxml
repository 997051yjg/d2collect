<view class="container theme-bg-diablo">
  <view class="bg-particles"></view>
  <view class="bg-texture"></view>

  <view class="page-content">
    
    <view class="login-gate animate-enter" wx:if="{{!isLoggedIn}}">
      <view class="gate-icon-wrapper">
        <image class="gate-icon" src="/images/4.png" mode="aspectFit" />
        <view class="gate-glow"></view>
      </view>
      <text class="gate-title">åœ£æ®¿çš„å¤§é—¨ç´§é—­</text>
      <text class="gate-subtitle">åªæœ‰çœŸæ­£çš„è‹±é›„æ‰èƒ½é€šè¿‡</text>
      
      <button class="btn-primary login-btn" bindtap="wxLogin">
        <text>å¼€å¯æ—…ç¨‹ (å¾®ä¿¡ç™»å½•)</text>
      </button>
    </view>

    <view class="profile-dashboard" wx:else>
      
      <view class="hero-card glass-card animate-enter">
        <view class="hero-header">
          <view class="avatar-rune-wrapper" bindtap="uploadAvatar">
            <view class="rune-ring {{uploadingAvatar ? 'spinning' : ''}}"></view>
            <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill" />
            <view class="avatar-badge">
              <icon type="success" size="12" color="#000" wx:if="{{!uploadingAvatar}}"/>
            </view>
          </view>
          
          <view class="hero-info">
            <view class="name-row">
              <block wx:if="{{!editing}}">
                <text class="hero-name gold-text">{{userInfo.nickName}}</text>
                <view class="edit-icon-wrapper" bindtap="startEditNickName">
                  <text class="edit-icon">âœ</text>
                </view>
              </block>
              <block wx:else>
                <input class="hero-name-input glass-pill" 
                       value="{{tempNickName}}" 
                       focus="{{editing}}"
                       bindinput="onNickNameInput"
                       bindblur="saveNickName"
                       bindconfirm="saveNickName"/>
              </block>
            </view>
            <text class="hero-class">{{userTitle || 'æµæµªè€…'}} (Lv.{{userLevel || 1}})</text>
          </view>
        </view>

        <view class="card-bg-decoration"></view>
      </view>

      <view class="stats-row animate-enter delay-1">
        <view class="stat-item glass-card" bindtap="viewCollectionStats">
          <text class="stat-label">å·è½´å·²å±•å¼€</text>
          <text class="stat-value gold-text">{{collectionStats.completionRate}}%</text>
          <view class="stat-bar-bg">
            <view class="stat-bar-fill" style="width: {{collectionStats.completionRate}}%"></view>
          </view>
        </view>
        <view class="stat-item glass-card" bindtap="viewCollectionStats">
          <text class="stat-label">åœ£ç‰©æ”¶é›†</text>
          <text class="stat-value">{{collectionStats.activatedCount}} <text class="stat-sub">/ {{collectionStats.totalCount}}</text></text>
        </view>
      </view>

      <view class="menu-list animate-enter delay-2">
        <view class="menu-group-title decorative-line">ç³»ç»Ÿé€‰é¡¹</view>
        
        <view class="menu-item glass-card" bindtap="viewCollectionStats">
          <view class="menu-left">
            <text class="menu-icon">ğŸ“œ</text>
            <text class="menu-text">èµ«æ‹‰è¿ªå§†å›¾é‰´</text>
          </view>
          <text class="menu-arrow">></text>
        </view>

        <view class="menu-item glass-card" bindtap="viewAchievements">
          <view class="menu-left">
            <text class="menu-icon">ğŸ†</text>
            <text class="menu-text">ç”Ÿæ¶¯æˆå°±</text>
          </view>
          <view class="menu-right">
            <text class="menu-tag">å¼€å‘ä¸­</text>
            <text class="menu-arrow">></text>
          </view>
        </view>

        <view class="menu-item glass-card logout" bindtap="logout">
          <view class="menu-left">
            <text class="menu-icon">ğŸšª</text>
            <text class="menu-text">ç¦»å¼€æ¸¸æˆ (é€€å‡º)</text>
          </view>
        </view>
      </view>

    </view>
  </view>
</view>