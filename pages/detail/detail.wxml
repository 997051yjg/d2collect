<!-- pages/detail/detail.wxml -->

<view class="detail-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- è£…å¤‡è¯¦æƒ… -->
  <view wx:if="{{!loading && equipment}}" class="equipment-detail">
    <!-- å¤´éƒ¨ä¿¡æ¯ -->
    <view class="equipment-header">
      <view class="emoji">{{getEquipmentEmoji(equipment.type)}}</view>
      <view class="info">
        <text class="name">{{equipment.name}}</text>
        <text class="type">{{equipment.type}} Â· {{equipment.rarity}}</text>
        <view class="status {{isActivated ? 'activated' : 'not-activated'}}">
          {{isActivated ? 'å·²æ¿€æ´»' : 'æœªæ¿€æ´»'}}
        </view>
      </view>
    </view>

    <!-- è£…å¤‡å›¾ç‰‡ -->
    <view class="image-section">
      <view class="image-preview" wx:if="{{isActivated && userEquipment && userEquipment.images && userEquipment.images[0]}}">
        <image 
          src="{{userEquipment.images[0]}}" 
          class="equipment-image {{showImage ? 'show' : 'hide'}}"
          mode="aspectFit"
          bindtap="viewImage"
        />
        <view class="image-controls">
          <button class="btn-view" bindtap="viewImage">æŸ¥çœ‹å¤§å›¾</button>
          <button class="btn-toggle" bindtap="toggleImage">
            {{showImage ? 'éšè—å›¾ç‰‡' : 'æ˜¾ç¤ºå›¾ç‰‡'}}
          </button>
        </view>
      </view>
      
      <view wx:else class="no-image">
        <view class="no-image-icon">ğŸ–¼ï¸</view>
        <text class="no-image-text">è¯¥è£…å¤‡å°šæœªæ¿€æ´»</text>
        <button class="btn-upload" bindtap="goToUpload">ä¸Šä¼ è£…å¤‡</button>
      </view>
    </view>

    <!-- è£…å¤‡å±æ€§ -->
    <view class="attributes-section">
      <view class="section-title">è£…å¤‡å±æ€§</view>
      <view class="attributes-list">
        <view class="attribute-item" wx:if="{{equipment.stats}}">
          <text class="label">å±æ€§ï¼š</text>
          <text class="value">{{equipment.stats}}</text>
        </view>
        <view class="attribute-item" wx:if="{{equipment.requiredLevel}}">
          <text class="label">éœ€æ±‚ç­‰çº§ï¼š</text>
          <text class="value">{{equipment.requiredLevel}}</text>
        </view>
      </view>
    </view>

    <!-- è£…å¤‡æè¿° -->
    <view class="description-section" wx:if="{{equipment.description}}">
      <view class="section-title">è£…å¤‡æè¿°</view>
      <view class="description-content">
        {{equipment.description}}
      </view>
    </view>
  </view>

  <!-- è£…å¤‡ä¸å­˜åœ¨ -->
  <view wx:if="{{!loading && !equipment}}" class="not-found">
    <view class="not-found-icon">â“</view>
    <text class="not-found-text">è£…å¤‡ä¸å­˜åœ¨</text>
    <button class="btn-back" bindtap="onBack">è¿”å›</button>
  </view>
</view>