# 装备模板数据更新说明

## 概述
此脚本用于根据中英文对照文件，自动更新装备模板数据库中的 `name_zh` 字段和 `image` 字段。

## 更新内容
1. **name_zh 字段**: 将英文或空白的 `name_zh` 字段更新为对应的中文名称
2. **image 字段**: 根据中文名称生成对应的云存储图片路径

## 使用步骤

### 1. 登录微信小程序云开发控制台
- 打开 [微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/devtools.html)
- 进入你的小程序项目
- 点击左侧菜单栏的"云开发"

### 2. 执行更新脚本
- 在云开发控制台中，点击左侧菜单栏的"数据库"
- 选择 `equipment_templates` 集合
- 点击右上角的"更多操作" -> "数据库操作"
- 在数据库操作界面中，选择"执行脚本"
- 将 `update_script.js` 文件的内容复制到脚本编辑器中
- 点击"执行"按钮

### 3. 查看执行结果
脚本执行后会显示详细的更新日志：
- 总共找到的装备模板数量
- 成功更新的装备数量
- 跳过的装备数量（已经包含中文的装备）
- 每个装备的具体更新信息

## 脚本功能特点

### 智能跳过机制
- 如果 `name_zh` 字段已经是中文文本，会自动跳过，避免重复更新
- 如果在中英文对照表中找不到对应的翻译，会显示警告并跳过

### 批量更新优化
- 使用 Promise.all() 进行批量并行更新，提高执行效率
- 详细的日志输出，便于跟踪执行过程

### 安全保护
- 只更新需要更新的字段，不会影响其他数据
- 包含完整的错误处理机制

## 中英文对照表
脚本包含一个完整的中英文对照表，涵盖了 372 个装备名称的翻译，包括：
- 暗金装备（Unique Items）
- 套装装备（Set Items）
- 符文之语（Runewords）

## 图片路径格式
更新后的 `image` 字段将使用以下格式：
```
cloud://cloud1-7g43dval99d60dca.636c-cloud1-7g43dval99d60dca-1385676003/unique_image/装备中文名称.png
```

## 注意事项
1. **备份数据**: 在执行脚本前，建议先备份数据库
2. **网络稳定**: 确保网络连接稳定，避免脚本执行中断
3. **权限检查**: 确保有足够的数据库操作权限
4. **图片文件**: 脚本只更新图片路径，需要确保云存储中已存在对应的图片文件

## 常见问题

### Q: 如果执行过程中出现错误怎么办？
A: 脚本包含完整的错误处理机制，会显示具体的错误信息。可以根据错误信息进行排查。

### Q: 如何确认更新是否成功？
A: 脚本执行后会显示详细的更新统计信息，包括更新数量和跳过数量。

### Q: 可以重复执行这个脚本吗？
A: 可以，脚本具有智能跳过机制，不会重复更新已经是中文的字段。

## 技术支持
如果在使用过程中遇到问题，可以查看脚本的详细日志输出，或联系技术支持。